---
title: 'Configurar Travis como herramienta para Integraci칩n y Despliegue cont칤nuo'
date: 2020-02-27
slug: '/travis-despliegue-integracion-continua'
banner: './travis-seo.png'
tags:
  - "游눹 Desarrollo"
---

Integraci칩n Continua o *Continuous Integration (CI)* y el Despliegue Continuo o *Continuous Deployment* son dos t칠rminos que suelen ser mencionados juntos. Se refiere a una serie de tareas repetitivas como son testing, building y desplegar a producci칩n una aplicaci칩n/web/software.

Por qu칠 esto es importante. Imagina que tienes el c칩digo de tu app o librer칤a *open source* en Github, la gente la usa, descarga, prueba, etc... y en alg칰n momento alguien hace un *fork* y env칤a una *pull request* para a침adir una nueva funcionalidad, corregir alg칰n bug, etc... De primeras, hacer esto manual solo te lleva un poco de tiempo, pero a la larga vas a querer automatizar esto, para centrarte en tu c칩digo y delegar las tareas que puedan ser "programadas".

## C칩mo funciona
### Integraci칩n Continua (CI)
Este proceso sirve para cuando un determinado software est치 desarrollado por varias personas y queremos automatizar su integraci칩n siguiendo el siguiente procedimiento:

1 - Subimos nuestros cambios en una rama a Github
2 - Un proceso se dispara
3 - La rama es descargada, se construye el software, y se corren los tests.
4 - El resultado se env칤a a d칩nde decidamos.

Si los test son OK, esto significa que el c칩digo puede ser *mergeado* de forma segura.

### Despliegue Continuo (CD)
Este proceso se utiliza mayormente cuando mergeamos una rama a m치ster:

1 - Se corren los test (idealmente de tipo E2E y m치s exahustivos que los que se hacen en CI)
2 - Se construye y dependiendo del tipo (app, librer칤a, etc...) se har치 una cosa u otra.
3 - Se despliega a un entorno de producci칩n o pre-producci칩n (*staging*, QA,...)

## C칩mo configurar este proceso
Hay varias herramientas y *SaaS* que te permiten configurar un entorno de integraci칩n y despliegue cont칤nuo. En este tutorial te voy a ense침ar a configurarlo con Github y [Travis CI](https://travis-ci.org)

![logo travis](./logo-travis.png)

### Repositorio
Lo primero que necesitas es tener to c칩digo en un repositorio. Si tu proyecto es *open source*, puedes usar [Github](https://github.com) y dejarlo libre sin costo, y eso te permite usar la versi칩n *Open* de Travis, para repositorios p칰blicos. 

### Conectar Travis CI a tu repositorio
Una vez tengas tu repo creado, dir칤gete a [Travis-CI](https://travis-ci.org) e inicia sesi칩n con tu cuenta de Github, esto permite a Travis ver tu lista de repos.
Busca el que quieres configurar y activalo con el switch a verde y despues clicka en *settings*.

![lista de repos](./travis-01.png)

En las *settings* te recomiendo que actives las opciones *Build pushed branches* y *Build pushed pull requests* para que Travis se ejecute en las PR que generes o te env칤e y tambien cuando 칠stas sean aceptadas y mergeadas a master.

### Fichero de configuraci칩n
Aqu칤 es donde entra la magia. Con un simple fichero que llamaremos `.travis.yml` y alojaremos en la raiz de nuestro proyecto, vamos a decirle a Travis lo que vamos a hacer. Al principio es un poco lioso, pero voy a explicarte paso a paso como hacerlo:

Veamos un ejemplo muy simple:

```yaml
language: node_js
node_js: "12"
script: 
  - "npm run lint"
  - "npm test"
  - "npm run build"
```

쯈u칠 estamos diciendo aqu칤?

- `language`: Si trabajamos con Javascript, lo m치s com칰n es decirle que es `node_js` y as칤 Travis crea una *maquina virtual* preparada para correr Node.js
- `node_js`: C칩mo estamos usando Node/Javascript, tenemos que indicar que versi칩n o versiones nos interesa que se pruebe nuestro software. En este caso le decimos que lo pruebe en `Node.js v12`
- `script`: Aqu칤 pondremos la series de comandos que queramos que se ejecuten en el entorno que crea Travis. como ejemplo he puesto un `npm run lint` que corra ESLint por ejemplo, `npm test` para que ejecute una bateria de tests que tengamos preparados, y por 칰ltimo `npm run build` que contruir칤a la versi칩n de producci칩n de nuestra app/librer칤a o software en general.

Si alguno de estos scripts fallase, Travis abortar칤a el proceso. S칩lo sera OK si todos los scripts no reportan ning칰n fallo.

### El proceso de integraci칩n continua.


